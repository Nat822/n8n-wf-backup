{"updatedAt":"2025-08-27T10:38:19.165Z","createdAt":"2025-08-27T10:37:27.884Z","id":"ZbU7L0CBSr2ICo6m","name":"image_gen_gemini","active":false,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict","sendQuery":true,"queryParameters":{"parameters":[{"name":"key","value":"=<api-key>"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n        \"instances\": [\n          {\n            \"prompt\": {{JSON.stringify($('Webhook').item.json.body.input)}}\n          }\n        ],\n        \"parameters\": {\n          \"sampleCount\": 1,\"aspectRatio\":\"{{$('Webhook').item.json.body.aspect_ratio}}\"\n        }\n      }","options":{"response":{}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[200,20],"id":"030ac2fd-a4ef-4162-9307-9e479a7df771","name":"Gemini - Generate Content"},{"parameters":{"operation":"toBinary","sourceProperty":"predictions[0].bytesBase64Encoded","options":{"fileName":"={{$execution.id+\"_\"+$node['Loop Over Items'].context.currentRunIndex}}.png"}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[440,20],"id":"3078ebe6-2514-456a-8178-8388197d26df","name":"Convert to File"},{"parameters":{"url":"={{ $('Webhook').item.json.body.image_url }}","options":{"response":{"response":{"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[200,400],"id":"5826ef2a-9929-44ff-95ca-7615c5f56710","name":"Download File1"},{"parameters":{"operation":"binaryToPropery","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[400,400],"id":"b035a740-5a63-434e-b9cc-ae13bf1d7ea0","name":"Extract from File1"},{"parameters":{"assignments":{"assignments":[{"id":"92294168-c579-4414-a3b6-311fd50aaa89","name":"inline_data","value":"={ \"mime_type\": \"{{ $('Download File1').item.binary.data.mimeType }}\", \"data\": \"{{$('Extract from File1').item.json.data  }}\" }","type":"object"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[580,400],"id":"103f757d-6e67-4b44-b650-2540dcc5c271","name":"Setup Data1"},{"parameters":{"method":"POST","url":"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent","sendQuery":true,"queryParameters":{"parameters":[{"name":"key","value":"=<api-key>"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n   \"contents\": [\n      {\n         \"parts\": [\n            {\n               \"text\": {{JSON.stringify($('Webhook').item.json.body.input)}}\n            }, {{JSON.stringify($json) }} \n         ]\n      }\n   ],\n\"generationConfig\": {\"responseModalities\": [\"Text\", \"Image\"]}\n}\n","options":{"response":{}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[760,400],"id":"bd2c2c1f-8bc1-4cf3-858e-411c01926fd5","name":"Gemini - Generate Content3"},{"parameters":{"operation":"toBinary","sourceProperty":"=candidates[0].content.parts[{{ $json.candidates[0].content.parts.length-1 }}].inlineData.data","options":{"fileName":"={{$execution.id+\"_\"+$node['Loop Over Items'].context.currentRunIndex}}.png"}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[980,400],"id":"d9940ad3-6212-4384-95b8-fe54f1ad865c","name":"Convert to File2"},{"parameters":{"content":"### Replace URL","height":224,"width":192},"type":"n8n-nodes-base.stickyNote","position":[160,360],"typeVersion":1,"id":"b78589c8-8113-4c14-b03a-d07454b02175","name":"Sticky Note"},{"parameters":{"content":"### Replace API key","height":224,"width":208},"type":"n8n-nodes-base.stickyNote","position":[700,360],"typeVersion":1,"id":"79b3c207-afc8-4731-a1a7-c42b9cfdc854","name":"Sticky Note1"},{"parameters":{"content":"### Replace API key","height":224,"width":224},"type":"n8n-nodes-base.stickyNote","position":[140,-40],"typeVersion":1,"id":"43a3ead7-b108-4691-83e7-ecde5c5eed48","name":"Sticky Note4"},{"parameters":{"content":"### Image generation with Imagen 4","height":96,"width":224},"type":"n8n-nodes-base.stickyNote","position":[-120,-40],"typeVersion":1,"id":"c0ef272d-7d15-425d-9e02-97c45d6f2904","name":"Sticky Note5"},{"parameters":{"content":"### Replace URL","height":224,"width":192},"type":"n8n-nodes-base.stickyNote","position":[180,920],"typeVersion":1,"id":"33dfe1f7-e22d-4772-9a47-5565a5fd89ee","name":"Sticky Note2"},{"parameters":{"content":"### Image editing with Gemini 2.0 Flash","height":96,"width":224},"type":"n8n-nodes-base.stickyNote","position":[-100,360],"typeVersion":1,"id":"fa28cc57-8fa7-4ea9-8b86-a161333fdb64","name":"Sticky Note6"}],"connections":{"Gemini - Generate Content":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"Download File1":{"main":[[{"node":"Extract from File1","type":"main","index":0}]]},"Extract from File1":{"main":[[{"node":"Setup Data1","type":"main","index":0}]]},"Setup Data1":{"main":[[{"node":"Gemini - Generate Content3","type":"main","index":0}]]},"Gemini - Generate Content3":{"main":[[{"node":"Convert to File2","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"versionId":"d792bd53-edd3-4b82-9af4-351e0bbd677d","triggerCount":0,"shared":[{"updatedAt":"2025-08-27T10:37:27.884Z","createdAt":"2025-08-27T10:37:27.884Z","role":"workflow:owner","workflowId":"ZbU7L0CBSr2ICo6m","projectId":"zwyEtHn1PnfmNkEl"}],"tags":[]}